<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>G150 샴푸추천 · 부들봇(따뜻/보습 시나리오)</title>
<link rel="preload" as="image" href="./g150-daily.png">
<style>
  /* 기존 살구톤 프레임 유지 */
  body{font-family:Arial,sans-serif;background:#fff8f0;margin:0;display:flex;justify-content:center;align-items:center;height:100vh}
  #chat-container{width:400px;background:#fff3e6;border-radius:10px;box-shadow:0 4px 8px rgba(0,0,0,.1);padding:20px;overflow-y:auto;max-height:90vh;line-height:1.8}
  .bot-message,.user-message{margin:10px 0;display:flex}
  .bot-message{justify-content:flex-start}.user-message{justify-content:flex-end}
  .message{padding:10px 15px;border-radius:20px;max-width:70%}
  .bot-message .message{background:#ffd8b1;color:#5a372a}
  .user-message .message{background:#ffcba4;color:#5a372a}
  .button-container{text-align:center;margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
  button{background:#ffad8f;color:#5a372a;border:none;border-radius:5px;padding:10px 20px;cursor:pointer}
  button:hover{background:#e69c7a}
  .image-container{text-align:center;margin:10px 0}
  .image-container img{width:100%;height:200px;object-fit:contain;border-radius:10px}
</style>
</head>
<body>
<div id="chat-container"></div>

<script>
const chatContainer=document.getElementById('chat-container');
const IMG_URL="./g150-daily.png";

/* 상태: 사용자 선택을 저장해 다음 멘트에 반영 */
let concern=null;   // '건조함' | '푸석함' | '윤기 부족'
let scent=null;     // '무향에 가까운' | '은은한 향'

/* 6턴(봇5 + 마지막 안내1), 정보 슬롯 고정:
   1 인사/공감 → 2 소개·고민 선택 → 3 추천 기준·향 선호 → 4 제품 소개(이미지) → 5 사용 가이드 → 6 안전/문서 */
const convo=[
  { type:'bot',
    text:'안녕하세요! 제가 도와드려도 될까요? 건조하고 푸석해진 모발을 편안하게 관리할 수 있도록 안내드릴게요 😊',
    buttons:[{label:'시작하기', next:1}]
  },
  { type:'bot',
    text:'보습 관련 핵심 정보를 순서대로 안내드립니다. 먼저, 가장 불편한 점을 선택해 주세요.',
    buttons:[
      {label:'건조함', next:2, onClick:()=>{concern='건조함'}},
      {label:'푸석함', next:2, onClick:()=>{concern='푸석함'}},
      {label:'윤기 부족', next:2, onClick:()=>{concern='윤기 부족'}}
    ]
  },
  { type:'bot',
    text:()=>`확인했어요. 추천 기준은 수분 유지력, 세정력 밸런스, 잔향의 은은함이에요. 향 선호를 알려주세요.`,
    buttons:[
      {label:'무향에 가까운', next:3, onClick:()=>{scent='무향에 가까운'}},
      {label:'은은한 향', next:3, onClick:()=>{scent='은은한 향'}}
    ]
  },
  { type:'bot',
    text:()=>`추천 제품은 <b>G150 Daily Shampoo</b>예요. ${concern?`특히 ${concern} 완화에 `:''}도움이 되도록 설계되었고, 사용 후 촉감 개선이 보고되었습니다. 향은 ${scent||'은은한 톤'}으로 부담 없이 사용할 수 있어요.`,
    image:IMG_URL,
    buttons:[{label:'계속', next:4}]
  },
  { type:'bot',
    text:'일반 권장 빈도는 주 3–4회예요. 모발에 도포 후 1–2분 유지하고 충분히 헹궈 주세요. 중간부터 끝 부분에는 가볍게 마사지해 주세요.',
    buttons:[{label:'자극이 걱정돼요', next:5}]
  },
  { type:'bot',
    text:'저자극 관련 시험을 통과했어요. 개인차가 있을 수 있으니 제품 라벨과 요약 문서를 함께 확인해 주세요.',
    buttons:[]
  }
];

function addRow(kind, html){
  const row=document.createElement('div'); row.className=kind==='bot'?'bot-message':'user-message';
  const msg=document.createElement('div'); msg.className='message'; msg.innerHTML=html;
  row.appendChild(msg); chatContainer.appendChild(row); chatContainer.scrollTop=chatContainer.scrollHeight;
}
function addImage(url){
  const c=document.createElement('div'); c.className='image-container';
  const img=document.createElement('img'); img.src=url; img.alt='G150 Daily Shampoo bottle'; img.loading='eager';
  c.appendChild(img); chatContainer.appendChild(c); chatContainer.scrollTop=chatContainer.scrollHeight;
}
function addButtons(btns){
  const bc=document.createElement('div'); bc.className='button-container';
  btns.forEach(b=>{
    const el=document.createElement('button'); el.textContent=b.label;
    el.onclick=()=>{ addRow('user', b.label); if(typeof b.onClick==='function') b.onClick(); if(b.next!==null && b.next!==undefined) step(b.next); };
    bc.appendChild(el);
  });
  chatContainer.appendChild(bc); chatContainer.scrollTop=chatContainer.scrollHeight;
}
function clearButtons(){ document.querySelectorAll('.button-container').forEach(n=>n.remove()); }

function step(i){
  clearButtons();
  const s=convo[i];
  if(!s) return;
  const text= typeof s.text==='function' ? s.text() : s.text;
  addRow('bot', text);
  if(s.image) addImage(s.image);
  if(s.buttons && s.buttons.length) addButtons(s.buttons);
}

/* 프리로드 후 시작 */
new Image().src=IMG_URL;
step(0);
</script>
</body>
</html>

